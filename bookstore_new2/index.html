<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Haven - Online Bookstore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .animate-fadeIn { animation: fadeIn 0.5s ease-out forwards; }
        .animate-slideIn { animation: slideIn 0.3s ease-out forwards; }
        .animate-pulse { animation: pulse 1.5s infinite; }

        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .dark .book-card:hover {
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.1);
        }

        .transition-all { transition: all 0.3s ease; }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .hero-title { font-size: 2rem; line-height: 2.5rem; }
            .hero-subtitle { font-size: 1rem; }
            .cart-sidebar { width: 100%; }
            .book-modal-content { flex-direction: column; }
            .book-modal-image { width: 100%; margin-bottom: 1rem; }
            .book-modal-details { width: 100%; }
            .checkout-modal { width: 95%; margin: 0 auto; }
        }
    </style>
</head>

<body class="bg-gray-100 dark:bg-gray-900 transition-colors duration-300">
    <div class="min-h-screen">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-md sticky top-0 z-50">
            <div class="container mx-auto px-4 py-3 sm:py-4 flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-book-open text-xl sm:text-2xl text-blue-600 dark:text-blue-400"></i>
                    <h1 class="text-xl sm:text-2xl font-bold text-gray-800 dark:text-white">Book Haven</h1>
                </div>
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <button id="cartBtn" class="relative p-1 sm:p-2 text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">
                        <i class="fas fa-shopping-cart text-lg sm:text-xl"></i>
                        <span id="cartCount" class="absolute -top-1 -right-1 bg-blue-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
                    </button>
                    <button id="themeToggle" class="p-1 sm:p-2 text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">
                        <i id="themeIcon" class="fas fa-moon text-lg sm:text-xl"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-6 sm:py-8">
            <!-- Hero Section -->
            <section class="mb-8 sm:mb-12 text-center animate-fadeIn">
                <h2 class="hero-title text-3xl sm:text-4xl font-bold text-gray-800 dark:text-white mb-3 sm:mb-4">Discover Your Next Favorite Book</h2>
                <p class="hero-subtitle text-base sm:text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">Browse our curated collection of bestsellers, classics, and hidden gems.</p>
            </section>

            <!-- Book Grid -->
            <section class="mb-8 sm:mb-12">
                <h3 class="text-xl sm:text-2xl font-semibold text-gray-800 dark:text-white mb-4 sm:mb-6">Featured Books</h3>
                <div class="grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6" id="bookGrid">
                    <!-- Book cards will be inserted here by JavaScript -->
                </div>
            </section>
        </main>

        <!-- Shopping Cart Sidebar -->
        <div id="cartSidebar" class="cart-sidebar fixed top-0 right-0 h-full w-full sm:w-96 bg-white dark:bg-gray-800 shadow-lg transform translate-x-full z-50 transition-transform duration-300 overflow-y-auto">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 class="text-lg sm:text-xl font-bold text-gray-800 dark:text-white">Your Cart</h3>
                <button id="closeCartBtn" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="cartItems" class="p-4">
                <div class="text-center py-8 text-gray-500 dark:text-gray-400" id="emptyCartMessage">
                    <i class="fas fa-shopping-cart text-4xl mb-4"></i>
                    <p>Your cart is empty</p>
                </div>
            </div>
            <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                <div class="flex justify-between mb-3 sm:mb-4">
                    <span class="font-semibold text-gray-700 dark:text-gray-300">Subtotal:</span>
                    <span id="cartSubtotal" class="font-bold text-gray-800 dark:text-white">$0.00</span>
                </div>
                <button id="checkoutBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 sm:py-3 px-4 rounded-lg transition-all animate-pulse">
                    Proceed to Checkout
                </button>
            </div>
        </div>

        <!-- Book Details Modal -->
        <div id="bookModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-2 sm:p-4 opacity-0 pointer-events-none transition-opacity duration-300">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transform translate-y-10 transition-transform duration-300">
                <div class="p-4 sm:p-6">
                    <div class="flex justify-between items-start mb-3 sm:mb-4">
                        <div>
                            <h3 id="modalBookTitle" class="text-xl sm:text-2xl font-bold text-gray-800 dark:text-white"></h3>
                            <p id="modalBookAuthor" class="text-sm sm:text-base text-gray-600 dark:text-gray-300"></p>
                        </div>
                        <button id="closeModalBtn" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div class="flex flex-col md:flex-row gap-4 sm:gap-6">
                        <div class="book-modal-image md:w-1/3">
                            <img id="modalBookImage" src="" alt="" class="w-full h-auto rounded-lg shadow-md">
                        </div>
                        <div class="book-modal-details md:w-2/3">
                            <p id="modalBookDescription" class="text-sm sm:text-base text-gray-700 dark:text-gray-300 mb-3 sm:mb-4"></p>
                            <div class="flex items-center mb-3 sm:mb-4">
                                <div class="flex text-yellow-400 mr-2">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span id="modalBookRating" class="text-xs sm:text-sm text-gray-600 dark:text-gray-300"></span>
                            </div>
                            <div class="flex items-center justify-between mb-3 sm:mb-4">
                                <span id="modalBookPrice" class="text-xl sm:text-2xl font-bold text-gray-800 dark:text-white"></span>
                                <button id="modalAddToCartBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 sm:py-2 px-3 sm:px-4 rounded-lg transition-all text-sm sm:text-base">
                                    Add to Cart
                                </button>
                            </div>
                            <div class="border-t border-gray-200 dark:border-gray-700 pt-3 sm:pt-4">
                                <h4 class="font-semibold text-gray-800 dark:text-white mb-1 sm:mb-2">Details</h4>
                                <ul class="text-xs sm:text-sm text-gray-600 dark:text-gray-300 space-y-1">
                                    <li><strong>Pages:</strong> <span id="modalBookPages"></span></li>
                                    <li><strong>Publisher:</strong> <span id="modalBookPublisher"></span></li>
                                    <li><strong>Language:</strong> <span id="modalBookLanguage"></span></li>
                                    <li><strong>ISBN:</strong> <span id="modalBookISBN"></span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Checkout Modal -->
        <div id="checkoutModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-2 sm:p-4 opacity-0 pointer-events-none transition-opacity duration-300">
            <div class="checkout-modal bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md transform translate-y-10 transition-transform duration-300">
                <div class="p-4 sm:p-6">
                    <div class="flex justify-between items-center mb-4 sm:mb-6">
                        <h3 class="text-lg sm:text-xl font-bold text-gray-800 dark:text-white">Complete Your Purchase</h3>
                        <button id="closeCheckoutBtn" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <form id="checkoutForm" class="space-y-3 sm:space-y-4">
                        <div>
                            <label for="cardNumber" class="block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Card Number</label>
                            <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" class="w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base">
                        </div>
                        <div class="grid grid-cols-2 gap-3 sm:gap-4">
                            <div>
                                <label for="expiryDate" class="block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Expiry Date</label>
                                <input type="text" id="expiryDate" placeholder="MM/YY" class="w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base">
                            </div>
                            <div>
                                <label for="cvv" class="block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">CVV</label>
                                <input type="text" id="cvv" placeholder="123" class="w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base">
                            </div>
                        </div>
                        <div>
                            <label for="nameOnCard" class="block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name on Card</label>
                            <input type="text" id="nameOnCard" placeholder="John Doe" class="w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base">
                        </div>
                        <div class="border-t border-gray-200 dark:border-gray-700 pt-3 sm:pt-4">
                            <div class="flex justify-between mb-1 sm:mb-2">
                                <span class="text-xs sm:text-sm text-gray-600 dark:text-gray-300">Subtotal:</span>
                                <span id="checkoutSubtotal" class="font-medium text-xs sm:text-sm text-gray-800 dark:text-white">$0.00</span>
                            </div>
                            <div class="flex justify-between mb-1 sm:mb-2">
                                <span class="text-xs sm:text-sm text-gray-600 dark:text-gray-300">Shipping:</span>
                                <span class="font-medium text-xs sm:text-sm text-gray-800 dark:text-white">$5.99</span>
                            </div>
                            <div class="flex justify-between text-base sm:text-lg font-bold">
                                <span class="text-gray-800 dark:text-white">Total:</span>
                                <span id="checkoutTotal" class="text-blue-600 dark:text-blue-400">$0.00</span>
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 sm:py-3 px-4 rounded-lg transition-all mt-3 sm:mt-4 text-sm sm:text-base">
                            Pay Now
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Payment Success Modal -->
        <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-2 sm:p-4 opacity-0 pointer-events-none transition-opacity duration-300">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md transform scale-95 transition-transform duration-300 text-center p-6 sm:p-8">
                <div class="text-green-500 text-5xl sm:text-6xl mb-3 sm:mb-4">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h3 class="text-xl sm:text-2xl font-bold text-gray-800 dark:text-white mb-1 sm:mb-2">Payment Successful!</h3>
                <p class="text-sm sm:text-base text-gray-600 dark:text-gray-300 mb-4 sm:mb-6">Thank you for your purchase. Your order has been placed successfully.</p>
                <button id="closeSuccessBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 sm:px-6 rounded-lg transition-all text-sm sm:text-base">
                    Continue Shopping
                </button>
            </div>
        </div>
    </div>

    <script>
        // Sample book data with reliable placeholder images
        const books = [
            {
                id: 1,
                title: "The Silent Patient",
                author: "Alex Michaelides",
                price: 15.99,
                image: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
                description: "Alicia Berenson's life is seemingly perfect. A famous painter married to an in-demand fashion photographer, she lives in a grand house overlooking a park in one of London's most desirable areas. One evening, her husband Gabriel returns home late, and Alicia shoots him five times in the face and then never speaks another word.",
                rating: "4.5 (12,345 reviews)",
                pages: 336,
                publisher: "Celadon Books",
                language: "English",
                isbn: "978-1250301697"
            },
            {
                id: 2,
                title: "Where the Crawdads Sing",
                author: "Delia Owens",
                price: 12.99,
                image: "https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
                description: "For years, rumors of the 'Marsh Girl' have haunted Barkley Cove, a quiet town on the North Carolina coast. So in late 1969, when handsome Chase Andrews is found dead, the locals immediately suspect Kya Clark, the so-called Marsh Girl. But Kya is not what they say. Sensitive and intelligent, she has survived for years alone in the marsh that she calls home, finding friends in the gulls and lessons in the sand.",
                rating: "4.8 (98,765 reviews)",
                pages: 384,
                publisher: "G.P. Putnam's Sons",
                language: "English",
                isbn: "978-0735219090"
            },
            {
                id: 3,
                title: "Educated",
                author: "Tara Westover",
                price: 14.99,
                image: "https://images.unsplash.com/photo-1589998059171-988d887df646?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
                description: "Tara Westover was 17 the first time she set foot in a classroom. Born to survivalists in the mountains of Idaho, she prepared for the end of the world by stockpiling home-canned peaches and sleeping with a 'head-for-the-hills bag'. In the summer she stewed herbs for her mother, a midwife and healer, and in the winter she salvaged metal in her father's junkyard.",
                rating: "4.7 (67,890 reviews)",
                pages: 352,
                publisher: "Random House",
                language: "English",
                isbn: "978-0399590504"
            },
            {
                id: 4,
                title: "Atomic Habits",
                author: "James Clear",
                price: 11.99,
                image: "https://images.unsplash.com/photo-1541963463532-d68292c34b19?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
                description: "Atomic Habits is a groundbreaking book that reveals how tiny changes can lead to remarkable results. James Clear explains how to build good habits and break bad ones, providing a framework for improving every day.",
                rating: "4.8 (45,678 reviews)",
                pages: 320,
                publisher: "Avery",
                language: "English",
                isbn: "978-0735211292"
            }
        ];

        // DOM Elements
        const bookGrid = document.getElementById('bookGrid');
        const cartBtn = document.getElementById('cartBtn');
        const closeCartBtn = document.getElementById('closeCartBtn');
        const cartSidebar = document.getElementById('cartSidebar');
        const cartItems = document.getElementById('cartItems');
        const cartCount = document.getElementById('cartCount');
        const cartSubtotalEl = document.getElementById('cartSubtotal');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const closeCheckoutBtn = document.getElementById('closeCheckoutBtn');
        const checkoutModal = document.getElementById('checkoutModal');
        const checkoutForm = document.getElementById('checkoutForm');
        const checkoutSubtotal = document.getElementById('checkoutSubtotal');
        const checkoutTotal = document.getElementById('checkoutTotal');
        const successModal = document.getElementById('successModal');
        const closeSuccessBtn = document.getElementById('closeSuccessBtn');
        const bookModal = document.getElementById('bookModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const modalAddToCartBtn = document.getElementById('modalAddToCartBtn');
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');

        // State
        let cart = [];
        let currentBookId = null;

        // Initialize the app
        function init() {
            renderBooks();
            setupEventListeners();
            loadThemePreference();
        }

        // Render books to the grid
        function renderBooks() {
            bookGrid.innerHTML = '';
            books.forEach(book => {
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 sm:p-4 transition-all animate-fadeIn';
                bookCard.innerHTML = `
                    <img src="${book.image}" alt="${book.title}" class="w-full h-40 sm:h-48 object-cover rounded-md mb-3 sm:mb-4">
                    <h4 class="text-base sm:text-lg font-semibold text-gray-800 dark:text-white">${book.title}</h4>
                    <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-300">${book.author}</p>
                    <p class="text-lg sm:text-xl font-bold text-gray-800 dark:text-white">$${book.price.toFixed(2)}</p>
                    <button class="mt-1 sm:mt-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 sm:py-2 px-3 sm:px-4 rounded-lg text-xs sm:text-sm" data-book-id="${book.id}">Read More</button>
                `;
                bookGrid.appendChild(bookCard);
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            // Book grid click events (delegated)
            bookGrid.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON' && e.target.hasAttribute('data-book-id')) {
                    const bookId = parseInt(e.target.getAttribute('data-book-id'));
                    openBookModal(bookId);
                }
            });

            // Cart buttons
            cartBtn.addEventListener('click', openCart);
            closeCartBtn.addEventListener('click', closeCart);

            // Modal buttons
            closeModalBtn.addEventListener('click', closeBookModal);
            modalAddToCartBtn.addEventListener('click', addToCartFromModal);

            // Checkout buttons
            checkoutBtn.addEventListener('click', openCheckoutModal);
            closeCheckoutBtn.addEventListener('click', closeCheckoutModal);
            checkoutForm.addEventListener('submit', handleCheckoutSubmit);

            // Success modal
            closeSuccessBtn.addEventListener('click', closeSuccessModal);

            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);

            // Close modals when clicking outside
            document.addEventListener('click', (e) => {
                if (e.target === bookModal) closeBookModal();
                if (e.target === checkoutModal) closeCheckoutModal();
                if (e.target === successModal) closeSuccessModal();
                if (e.target === cartSidebar && window.innerWidth < 640) closeCart();
            });
        }

        // Book modal functions
        function openBookModal(bookId) {
            currentBookId = bookId;
            const book = books.find(b => b.id === bookId);
            
            document.getElementById('modalBookTitle').textContent = book.title;
            document.getElementById('modalBookAuthor').textContent = book.author;
            document.getElementById('modalBookDescription').textContent = book.description;
            document.getElementById('modalBookImage').src = book.image;
            document.getElementById('modalBookPrice').textContent = `$${book.price.toFixed(2)}`;
            document.getElementById('modalBookRating').textContent = book.rating;
            document.getElementById('modalBookPages').textContent = book.pages;
            document.getElementById('modalBookPublisher').textContent = book.publisher;
            document.getElementById('modalBookLanguage').textContent = book.language;
            document.getElementById('modalBookISBN').textContent = book.isbn;

            bookModal.classList.remove('opacity-0', 'pointer-events-none');
            bookModal.classList.add('opacity-100');
        }

        function closeBookModal() {
            bookModal.classList.add('opacity-0', 'pointer-events-none');
            currentBookId = null;
        }

        // Cart functions
        function openCart() {
            cartSidebar.classList.remove('translate-x-full');
        }

        function closeCart() {
            cartSidebar.classList.add('translate-x-full');
        }

        function addToCartFromModal() {
            if (!currentBookId) return;
            
            const book = books.find(b => b.id === currentBookId);
            cart.push(book);
            updateCart();
            closeBookModal();
            
            // Show cart on mobile after adding
            if (window.innerWidth < 640) {
                openCart();
            }
        }

        function updateCart() {
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                document.getElementById('emptyCartMessage').style.display = 'block';
            } else {
                document.getElementById('emptyCartMessage').style.display = 'none';
                
                cart.forEach((item, index) => {
                    const cartItem = document.createElement('div');
                    cartItem.className = 'flex justify-between items-center mb-3 sm:mb-4';
                    cartItem.innerHTML = `
                        <div>
                            <h4 class="text-sm sm:text-base text-gray-800 dark:text-white">${item.title}</h4>
                            <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-300">$${item.price.toFixed(2)}</p>
                        </div>
                        <button class="text-red-500" data-cart-index="${index}"><i class="fas fa-trash text-sm sm:text-base"></i></button>
                    `;
                    cartItems.appendChild(cartItem);
                });
            }
            
            // Calculate subtotal
            const subtotal = cart.reduce((sum, item) => sum + item.price, 0);
            cartSubtotalEl.textContent = `$${subtotal.toFixed(2)}`;
            cartCount.textContent = cart.length;
            
            // Update checkout totals if checkout modal is open
            if (!checkoutModal.classList.contains('opacity-0')) {
                checkoutSubtotal.textContent = `$${subtotal.toFixed(2)}`;
                checkoutTotal.textContent = `$${(subtotal + 5.99).toFixed(2)}`;
            }
            
            // Add event listeners to remove buttons
            document.querySelectorAll('[data-cart-index]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = parseInt(e.currentTarget.getAttribute('data-cart-index'));
                    cart.splice(index, 1);
                    updateCart();
                });
            });
        }

        // Checkout functions
        function openCheckoutModal() {
            const subtotal = cart.reduce((sum, item) => sum + item.price, 0);
            checkoutSubtotal.textContent = `$${subtotal.toFixed(2)}`;
            checkoutTotal.textContent = `$${(subtotal + 5.99).toFixed(2)}`;
            
            checkoutModal.classList.remove('opacity-0', 'pointer-events-none');
            checkoutModal.classList.add('opacity-100');
        }

        function closeCheckoutModal() {
            checkoutModal.classList.add('opacity-0', 'pointer-events-none');
        }

        function handleCheckoutSubmit(e) {
            e.preventDefault();
            
            // Simple validation
            const cardNumber = document.getElementById('cardNumber').value;
            const expiryDate = document.getElementById('expiryDate').value;
            const cvv = document.getElementById('cvv').value;
            const nameOnCard = document.getElementById('nameOnCard').value;
            
            if (!cardNumber || !expiryDate || !cvv || !nameOnCard) {
                alert('Please fill in all payment details');
                return;
            }
            
            closeCheckoutModal();
            openSuccessModal();
            
            // Clear cart
            cart = [];
            updateCart();
            closeCart();
            
            // Reset form
            checkoutForm.reset();
        }

        // Success modal functions
        function openSuccessModal() {
            successModal.classList.remove('opacity-0', 'pointer-events-none');
            successModal.classList.add('opacity-100');
        }

        function closeSuccessModal() {
            successModal.classList.add('opacity-0', 'pointer-events-none');
        }

        // Theme functions
        function toggleTheme() {
            document.body.classList.toggle('dark');
            themeIcon.classList.toggle('fa-moon');
            themeIcon.classList.toggle('fa-sun');
            
            // Save preference to localStorage
            const isDark = document.body.classList.contains('dark');
            localStorage.setItem('darkMode', isDark);
        }

        function loadThemePreference() {
            const darkMode = localStorage.getItem('darkMode') === 'true';
            if (darkMode) {
                document.body.classList.add('dark');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>